<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Consulta y GestiÃ³n de Datos</title>
  <link rel="stylesheet" href="css/estilos.css">
</head>

<body>

<header>
  <h1>Consulta y GestiÃ³n de Datos</h1>
</header>

<main>

<!-- EVENTOS -->
<section>
  <h2>ğŸ“… Eventos</h2>
  <ul id="listaEventos"></ul>
</section>

<!-- UBICACIONES -->
<section>
  <h2>ğŸ“ Ubicaciones</h2>
  <ul id="listaUbicaciones"></ul>
</section>

<!-- CONTACTOS -->
<section>
  <h2>ğŸ‘¤ Contactos</h2>
  <ul id="listaContactos"></ul>
</section>

<a href="index.html" class="btn-regresar">â† Regresar</a>

</main>

<footer>
  <p>&copy; 2025 - GestiÃ³n de Eventos</p>
</footer>

<!-- ğŸ”¥ FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import {
  getFirestore,
  collection,
  getDocs,
  deleteDoc,
  updateDoc,
  doc
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCR9vM3HNZ0QyCpi0tLV-g865VQ53XcBP4",
  authDomain: "gestion-eventos-steven.firebaseapp.com",
  projectId: "gestion-eventos-steven"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* ================= EVENTOS ================= */
const eventosSnap = await getDocs(collection(db, "eventos"));
eventosSnap.forEach(d => {
  const e = d.data();
  listaEventos.innerHTML += `
    <li>
      <strong>${e.titulo}</strong><br>
      ğŸ“… ${e.fecha} â° ${e.hora}<br>
      ğŸ“ ${e.lugar || "-"}<br>

      <button onclick="editarEvento('${d.id}', '${e.titulo}')">âœï¸ Editar</button>
      <button onclick="eliminarEvento('${d.id}')">ğŸ—‘ï¸ Eliminar</button>
    </li>
    <hr>
  `;
});

window.eliminarEvento = async function(id) {
  if (confirm("Â¿Eliminar este evento?")) {
    await deleteDoc(doc(db, "eventos", id));
    alert("âœ… Evento eliminado");
    location.reload();
  }
};

window.editarEvento = async function(id, tituloActual) {
  const nuevoTitulo = prompt("Editar tÃ­tulo del evento:", tituloActual);
  if (nuevoTitulo) {
    await updateDoc(doc(db, "eventos", id), { titulo: nuevoTitulo });
    alert("âœï¸ Evento actualizado");
    location.reload();
  }
};

/* ================= UBICACIONES ================= */
const ubicSnap = await getDocs(collection(db, "ubicaciones"));
ubicSnap.forEach(d => {
  const u = d.data();
  listaUbicaciones.innerHTML += `
    <li>
      <strong>${u.titulo}</strong><br>
      ğŸ“ ${u.direccion}<br>
      ğŸŒ ${u.latitud || "-"}, ${u.longitud || "-"}<br>

      <button onclick="eliminarUbicacion('${d.id}')">ğŸ—‘ï¸ Eliminar</button>
    </li>
    <hr>
  `;
});

window.eliminarUbicacion = async function(id) {
  if (confirm("Â¿Eliminar esta ubicaciÃ³n?")) {
    await deleteDoc(doc(db, "ubicaciones", id));
    alert("âœ… UbicaciÃ³n eliminada");
    location.reload();
  }
};

/* ================= CONTACTOS ================= */
const contSnap = await getDocs(collection(db, "contactos"));
contSnap.forEach(d => {
  const c = d.data();
  listaContactos.innerHTML += `
    <li>
      <strong>${c.nombre}</strong><br>
      ğŸ“ ${c.telefono || "-"}<br>
      ğŸ“§ ${c.email || "-"}<br>
      ğŸ·ï¸ ${c.tipo || "-"}<br>

      <button onclick="eliminarContacto('${d.id}')">ğŸ—‘ï¸ Eliminar</button>
    </li>
    <hr>
  `;
});

window.eliminarContacto = async function(id) {
  if (confirm("Â¿Eliminar este contacto?")) {
    await deleteDoc(doc(db, "contactos", id));
    alert("âœ… Contacto eliminado");
    location.reload();
  }
};
</script>

</body>
</html>


